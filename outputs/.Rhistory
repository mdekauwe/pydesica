Tair=25,
VPD=1.5,
Wind = 2,
Wleaf = 0.02,
StomatalRatio = 1,   # 2 for amphistomatous
LeafAbs = 0.86
Tair=25
VPD=1.5
Wind = 2
Wleaf = 0.02
StomatalRatio = 1
LeafAbs = 0.86
Tleaf = 21.5
Tair = 20.
gs = 0.15
PPFD = 1500; VPD = 2; Patm = 101
Wind = 2; Wleaf = 0.02
Boltz <- 5.67 * 10^-8     # w M-2 K-4
Emissivity <- 0.95        # -
LatEvap <- 2.54           # MJ kg-1
CPAIR <- 1010.0           # J kg-1 K-1
H2OLV0 <- 2.501e6         # J kg-1
H2OMW <- 18e-3            # J kg-1
AIRMA <- 29.e-3           # mol mass air (kg/mol)
AIRDENS <- 1.204          # kg m-3
UMOLPERJ <- 4.57
DHEAT <- 21.5e-6          # molecular diffusivity for heat
AIRDENS <- Patm*1000/(287.058 * Tk(Tair))
Tk <- function(x)x+273.15
AIRDENS <- Patm*1000/(287.058 * Tk(Tair))
AIRDENS
LHV <- (H2OLV0 - 2.365E3 * Tair) * H2OMW
air_density = pressure  / (c.RSPECIFC_DRY_AIR * tair_k)
air_density = pressure  / (c.RSPECIFC_DRY_AIR * tair_k)
Tk
air_density
AIRDENS
LHV <- (H2OLV0 - 2.365E3 * Tair) * H2OMW
LHV
SLOPE <- (esat(Tair + 0.1) - esat(Tair)) / 0.1
esat <- function(TdegC){
a = 613.75
b = 17.502
c = 240.97
esat = a * exp( (b * TdegC) / (c + tair) )
return(esatval)
}
SLOPE <- (esat(Tair + 0.1) - esat(Tair)) / 0.1
Tair
SLOPE <- (esat(Tair + 0.1) - esat(Tair)) / 0.1
esat <- function(TdegC){
a = 613.75
b = 17.502
c = 240.97
esat = a * exp( (b * TdegC) / (c + TdegC) )
return(esatval)
}
SLOPE <- (esat(Tair + 0.1) - esat(Tair)) / 0.1
esat <- function(TdegC){
a = 613.75
b = 17.502
c = 240.97
esatval = a * exp( (b * TdegC) / (c + TdegC) )
return(esatval)
}
SLOPE <- (esat(Tair + 0.1) - esat(Tair)) / 0.1
SLOPE
Gradiation <- 4.*Boltz*Tk(Tair)^3 * Emissivity / (CPAIR * AIRMA)
Gradiation
Emissivity
Boltz
Tk(Tair)^3
Tk(Tair)
Tk(Tair)^3.
a = Tk(Tair)^3.
a
a = Tk(Tair)**3.
a
Gradiation
wind
cmolar
CMOLAR <- Patm*1000 / (8.314 * Tk(Tair))
CMOLAR
Gbhforced <- 0.003 * sqrt(Wind/Wleaf) * CMOLAR
Gbhforced
GRASHOF <- 1.6E8 * abs(Tleaf-Tair) * (Wleaf^3)
GRASHOF
Gbhfree <- 0.5 * DHEAT * (GRASHOF^0.25) / Wleaf * CMOLAR
Gbhfree
Gbh <- 2*(Gbhfree + Gbhforced)
Gbhr <- Gbh + 2*Gradiation
Gbw <- StomatalRatio * 1.075 * Gbh  # Leuning 1995
gw <- gs*Gbw/(gs + Gbw)
gs
gq
gw
gbq
gbw
Gbw
StomatalRatio
gw
Gbh
Gbhr
Gbw <- StomatalRatio * 1.075 * Gbh  # Leuning 1995Gbw <- StomatalRatio * 1.075 * Gbh  # Leuning 1995
Gbw
gw <- gs*Gbw/(gs + Gbw)
gw
GAMMA <- CPAIR*AIRMA*Patm*1000/LHV
GAMMA
Rlongup <- Emissivity*Boltz*Tk(Tleaf)^4
Rsol <- 2*PPFD/UMOLPERJ
Rnet <- LeafAbs*Rsol - Rlongup
ea <- esat(Tair) - 1000*VPD
ema <- 0.642*(ea/Tk(Tair))^(1/7)
Rnetiso <- LeafAbs*Rsol - (1 - ema)*Boltz*Tk(Tair)^4 # isothermal net radiation
Rnetiso
PPFD
VPD
Rnetiso
Rsol <- 2*PPFD/UMOLPERJ
Rsol
PPFD/UMOLPERJ
UMOLPERJ
2.0/UMOLPERJ
ea
Rnet <- LeafAbs*Rsol - Rlongup
Rnet
ema <- 0.642*(ea/Tk(Tair))^(1/7)
ena
ema
Rnetiso <- LeafAbs*Rsol - (1 - ema)*Boltz*Tk(Tair)^4
Rnetiso
LeafAbs
LeafAbs*Rsol
(1 - ema)*Boltz*Tk(Tair)^4
ET <- (1/LHV) * (SLOPE * Rnetiso + 1000*VPD * Gbh * CPAIR * AIRMA) / (SLOPE + GAMMA * Gbhr/gw)
ET
lambdaET <- LHV * ET
lambdaET
Gbh
(SLOPE * Rnetiso + 1000*VPD * Gbh * CPAIR * AIRMA)
Rnetiso
CPAIR
AIRMA
SLOPE
(SLOPE * Rnetiso + 1000*VPD * Gbh * CPAIR * AIRMA)
Gbh
Gbh <- 2*(Gbhfree + Gbhforced)
Gbh
(SLOPE + GAMMA * Gbhr/gw)
Gbhr
gw
Gbh
Gbh <- 2*(Gbhfree + Gbhforced)
Gbh
library(ggplot2)
library(phenocamr)
install.packages("phenocamr")
library(ggplot2)
library(phenocamr)
download_phenocam(site = "harvard$",
veg_type = "DB",
roi_id = "1000",
frequency = "3")
df <- read_phenocam(file.path(tempdir(),"harvard_DB_1000_3day.csv"))
data_Harvard<-df$data
View(data_Harvard)
ggplot(data_Harvard, aes(doy, gcc_mean))+
geom_point()+
geom_smooth(method="loess", span=0.1)+
theme_classic()
ggplot(data_Harvard, aes(doy, gcc_mean, colour=year))+
geom_point()+
geom_smooth(method="loess", span=0.1)+
theme_classic()+
scale_color_viridis_c() #this can be changed to a different color scheme
ggplot(data_Harvard, aes(doy, gcc_mean, colour=year))+
geom_point()+
geom_smooth(method="loess", span=0.1)+
theme_classic()
ggplot(data_Harvard, aes(doy, gcc_mean, colour=year))+
geom_point()+
geom_smooth(method="loess", span=0.1)+
theme_classic()+scale_color_viridis_c()
ggplot(data_Harvard, aes(doy, gcc_mean, colour=year))+
geom_point()+
geom_smooth(method="loess", span=0.1)+
theme_classic()+scale_color_viridis_c()
ggplot(data_Harvard, aes(doy, gcc_mean, colour=doy))+
geom_point()+
geom_smooth(method="loess", span=0.1, col="black")+
theme_classic()+
scale_color_viridis_c()+
facet_wrap(~year)
ggplot(data_Harvard, aes(doy, gcc_mean, colour=doy))+
geom_point()+
geom_smooth(method="loess", span=0.1, col="black")+
theme_classic()+
scale_color_viridis_c()+
facet_wrap(~year)
ggplot(data_Harvard, aes(doy, gcc_mean, colour=year))+
geom_point()+
geom_smooth(method="loess", span=0.1)+
theme_classic()+scale_color_viridis_c()ggplot(data_Harvard, aes(doy, gcc_mean, colour=doy))+
geom_point()+
geom_smooth(method="loess", span=0.1, col="black")+
theme_classic()+
facet_wrap(~year)
ggplot(data_Harvard, aes(doy, gcc_mean, colour=doy))+
geom_point()+
geom_smooth(method="loess", span=0.1, col="black")+
theme_classic()+
facet_wrap(~year)
AMF_US_Ha1_BASE_HR_10_1$Year<-substr(AMF_US_Ha1_BASE_HR_10_1$Date_time, 1,4)
ggplot(data_Harvard, aes(doy, gcc_mean, colour=year))+
geom_point()+
geom_smooth(method="loess", span=0.1)+
theme_classic()
library(visreg)
library(ggplot2)
library(ppcor)
library(relaimpo)
library(tidyverse)
setwd("/Users/mdekauwe/src/python/pydesica/outputs")
pft = "dsf"
fname <- sprintf("%s_trait_sensitivity.csv", pft)
df <- read.csv(fname)
#head(df)
fit <- lm(plc ~ gmin + p50 + Cl + Cs + depth, data=df)
#visreg(fit)
par(mfrow=c(2,3))
visreg(fit, "gmin")
visreg(fit, "p50")
visreg(fit, "Cl")
visreg(fit, "Cs")
visreg(fit, "depth")
df_dead <- df %>% filter(day_of_death > 0)
dev.off()
ggplot(df_dead, aes(x=day_of_death)) + geom_histogram()
setwd("/Users/mdekauwe/src/python/pydesica/outputs")
pft = "saw"
fname <- sprintf("%s_trait_sensitivity.csv", pft)
df <- read.csv(fname)
df_dead <- df %>% filter(day_of_death > 0)
dev.off()
ggplot(df_dead, aes(x=day_of_death)) + geom_histogram()
rel_imp <- calc.relimp(fit, type=c("lmg","last", "first"), rela=TRUE)
plot(rel_imp)
boot <- boot.relimp(fit, b=1000, type=c("lmg","last", "first"),
rank=TRUE, diff=TRUE, rela=TRUE)
#booteval.relimp(boot)
plot(booteval.relimp(boot, sort=TRUE))
df_dead <- df %>% filter(day_of_death > 0)
dev.off()
ggplot(df_dead, aes(x=day_of_death)) + geom_histogram()
fit <- lm(day_of_death ~ gmin + p50 + Cl + Cs + depth, data=df_dead)
rel_imp <- calc.relimp(fit, type=c("lmg","last", "first"), rela=TRUE)
plot(rel_imp)
boot <- boot.relimp(fit, b=1000, type=c("lmg","last", "first"),
rank=TRUE, diff=TRUE, rela=TRUE)
#booteval.relimp(boot)
plot(booteval.relimp(boot, sort=TRUE))
rel_imp <- calc.relimp(fit, type=c("lmg","last", "first"), rela=TRUE)
plot(rel_imp)
boot <- boot.relimp(fit, b=1000, type=c("lmg","last", "first"),
rank=TRUE, diff=TRUE, rela=TRUE)
#booteval.relimp(boot)
plot(booteval.relimp(boot, sort=TRUE))
fit <- lm(plc ~ gmin + p50 + Cl + Cs + depth, data=df)
rel_imp <- calc.relimp(fit, type=c("lmg","last", "first"), rela=TRUE)
plot(rel_imp)
boot <- boot.relimp(fit, b=1000, type=c("lmg","last", "first"),
rank=TRUE, diff=TRUE, rela=TRUE)
#booteval.relimp(boot)
plot(booteval.relimp(boot, sort=TRUE))
pft = "saw"
fname <- sprintf("%s_trait_sensitivity.csv", pft)
df <- read.csv(fname)
#head(df)
fit <- lm(plc ~ gmin + p50 + Cl + Cs + depth, data=df)
#visreg(fit)
par(mfrow=c(2,3))
visreg(fit, "gmin")
visreg(fit, "p50")
visreg(fit, "Cl")
visreg(fit, "Cs")
visreg(fit, "depth")
pft = "saw"
fname <- sprintf("%s_trait_sensitivity.csv", pft)
df <- read.csv(fname)
#head(df)
fit <- lm(plc ~ gmin + p50 + Cl + Cs + depth, data=df)
visreg(fit)
rel_imp <- calc.relimp(fit, type=c("lmg","last", "first"), rela=TRUE)
plot(rel_imp)
fit <- lm(plc ~ gmin + p50 + depth, data=df)
visreg(fit)
df_dead <- df %>% filter(day_of_death > 0)
dev.off()
ggplot(df_dead, aes(x=day_of_death)) + geom_histogram()
fit <- lm(day_of_death ~ gmin + p50 + Cl + Cs + depth, data=df_dead)
visreg(fit)
visreg(fit, "Cs")
visreg(fit, "depth")
par(mfrow=c(2,3))
visreg(fit, "gmin")
visreg(fit, "p50")
visreg(fit, "Cl")
visreg(fit, "Cs")
visreg(fit, "depth")
rel_imp <- calc.relimp(fit, type=c("lmg","last", "first"), rela=TRUE)
plot(rel_imp)
par(mfrow=c(2,3))
visreg(fit, "gmin")
visreg(fit, "p50")
visreg(fit, "Cl")
visreg(fit, "Cs")
visreg(fit, "depth")
summary(fit)
pft = "dsf"
fname <- sprintf("%s_trait_sensitivity.csv", pft)
df <- read.csv(fname)
df_dead <- df %>% filter(day_of_death > 0)
fit <- lm(day_of_death ~ gmin + p50 + Cl + Cs + depth, data=df_dead)
#visreg(fit)
par(mfrow=c(2,3))
visreg(fit, "gmin")
visreg(fit, "p50")
visreg(fit, "Cl")
visreg(fit, "Cs")
visreg(fit, "depth")
visreg(fit, "p50")
dev.off()
visreg(fit, "p50")
